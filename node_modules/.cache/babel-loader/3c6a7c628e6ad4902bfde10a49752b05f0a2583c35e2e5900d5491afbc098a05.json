{"ast":null,"code":"var _jsxFileName = \"/workspace/frontend-project5/src/components/follow/FollowButton.js\",\n  _s = $RefreshSig$();\nimport axios from 'axios';\nimport { useState, useEffect } from 'react';\nimport Button from 'react-bootstrap/Button';\nimport Spinner from 'react-bootstrap/Spinner'; // Import Spinner\nimport buttonStyles from '../../styles/Buttons.module.css';\nimport { useCurrentUser } from '../../contexts/CurrentUserContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst FollowButton = _ref => {\n  _s();\n  let {\n    profileId,\n    username\n  } = _ref;\n  const [isFollowing, setIsFollowing] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null); // State for error handling\n  const currentUser = useCurrentUser();\n  useEffect(() => {\n    const checkIfFollowing = async () => {\n      try {\n        const response = await axios.get(`/profiles/${username}/is_following/`);\n        setIsFollowing(response.data.is_following);\n      } catch (error) {\n        console.error(\"Error checking follow status:\", error);\n        setError(\"Could not determine follow status.\"); // Set error message\n      }\n    };\n\n    if ((currentUser === null || currentUser === void 0 ? void 0 : currentUser.username) !== username) {\n      checkIfFollowing();\n    }\n  }, [username, currentUser]);\n  const handleFollow = async () => {\n    if (loading) return; // Prevent multiple submissions\n    setLoading(true);\n    setError(null); // Reset error state\n    try {\n      if (isFollowing) {\n        const response = await axios.delete(`/profiles/${username}/unfollow/`);\n        if (response.status === 204) {\n          setIsFollowing(false);\n        }\n      } else {\n        const response = await axios.post(`/profiles/${username}/follow/`);\n        if (response.status === 201) {\n          setIsFollowing(true);\n        }\n      }\n    } catch (error) {\n      console.error(\"Error handling follow/unfollow:\", error);\n      setError(\"Something went wrong. Please try again.\"); // Update error state\n    } finally {\n      setLoading(false);\n    }\n  };\n  if ((currentUser === null || currentUser === void 0 ? void 0 : currentUser.username) === username) {\n    return null;\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [error && /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"text-danger\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 17\n    }, this), \" \", /*#__PURE__*/_jsxDEV(Button, {\n      className: buttonStyles.follow,\n      onClick: handleFollow,\n      disabled: loading,\n      \"aria-label\": isFollowing ? \"Unfollow\" : \"Follow\" // Accessibility\n      ,\n      children: loading ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(Spinner, {\n          animation: \"border\",\n          size: \"sm\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 13\n        }, this), \" \", \"Processing...\"]\n      }, void 0, true) : isFollowing ? \"Unfollow\" : \"Follow\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 59,\n    columnNumber: 5\n  }, this);\n};\n_s(FollowButton, \"d3/eYAb3G21Qkwm5tG1oCagp1Wk=\", false, function () {\n  return [useCurrentUser];\n});\n_c = FollowButton;\nexport default FollowButton;\nvar _c;\n$RefreshReg$(_c, \"FollowButton\");","map":{"version":3,"names":["axios","useState","useEffect","Button","Spinner","buttonStyles","useCurrentUser","jsxDEV","_jsxDEV","Fragment","_Fragment","FollowButton","_ref","_s","profileId","username","isFollowing","setIsFollowing","loading","setLoading","error","setError","currentUser","checkIfFollowing","response","get","data","is_following","console","handleFollow","delete","status","post","children","className","fileName","_jsxFileName","lineNumber","columnNumber","follow","onClick","disabled","animation","size","_c","$RefreshReg$"],"sources":["/workspace/frontend-project5/src/components/follow/FollowButton.js"],"sourcesContent":["import axios from 'axios';\nimport { useState, useEffect } from 'react';\nimport Button from 'react-bootstrap/Button';\nimport Spinner from 'react-bootstrap/Spinner'; // Import Spinner\nimport buttonStyles from '../../styles/Buttons.module.css';\nimport { useCurrentUser } from '../../contexts/CurrentUserContext';\n\nconst FollowButton = ({ profileId, username }) => {\n  const [isFollowing, setIsFollowing] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null); // State for error handling\n  const currentUser = useCurrentUser();\n\n  useEffect(() => {\n    const checkIfFollowing = async () => {\n      try {\n        const response = await axios.get(`/profiles/${username}/is_following/`);\n        setIsFollowing(response.data.is_following);\n      } catch (error) {\n        console.error(\"Error checking follow status:\", error);\n        setError(\"Could not determine follow status.\"); // Set error message\n      }\n    };\n\n    if (currentUser?.username !== username) {\n      checkIfFollowing();\n    }\n  }, [username, currentUser]);\n\n  const handleFollow = async () => {\n    if (loading) return; // Prevent multiple submissions\n    setLoading(true);\n    setError(null); // Reset error state\n    try {\n      if (isFollowing) {\n        const response = await axios.delete(`/profiles/${username}/unfollow/`);\n        if (response.status === 204) {\n          setIsFollowing(false);\n        }\n      } else {\n        const response = await axios.post(`/profiles/${username}/follow/`);\n        if (response.status === 201) {\n          setIsFollowing(true);\n        }\n      }\n    } catch (error) {\n      console.error(\"Error handling follow/unfollow:\", error);\n      setError(\"Something went wrong. Please try again.\"); // Update error state\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (currentUser?.username === username) {\n    return null;\n  }\n\n  return (\n    <div>\n      {error && <p className=\"text-danger\">{error}</p>} {/* Display error message */}\n      <Button\n        className={buttonStyles.follow}\n        onClick={handleFollow}\n        disabled={loading}\n        aria-label={isFollowing ? \"Unfollow\" : \"Follow\"} // Accessibility\n      >\n        {loading ? (\n          <>\n            <Spinner animation=\"border\" size=\"sm\" /> {/* Spinner for loading */}\n            Processing...\n          </>\n        ) : (\n          isFollowing ? \"Unfollow\" : \"Follow\"\n        )}\n      </Button>\n    </div>\n  );\n};\n\nexport default FollowButton;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}