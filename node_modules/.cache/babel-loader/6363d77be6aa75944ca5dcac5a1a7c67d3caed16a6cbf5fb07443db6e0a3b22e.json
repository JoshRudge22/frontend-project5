{"ast":null,"code":"var _jsxFileName = \"/workspace/frontend-project5/src/components/interactions/Likes.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport Button from 'react-bootstrap/Button';\nimport { Link } from 'react-router-dom';\nimport likeStyles from '../../styles/likes/Likes.module.css';\nimport buttonStyles from '../../styles/Buttons.module.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction Likes(_ref) {\n  _s();\n  let {\n    postId,\n    currentUser\n  } = _ref;\n  const [liked, setLiked] = useState(null);\n  const [likesCount, setLikesCount] = useState(0);\n  const [errorMessage, setErrorMessage] = useState('');\n  const [loading, setLoading] = useState(false); // Loading state\n\n  useEffect(() => {\n    const fetchLikes = async () => {\n      setLoading(true); // Set loading to true when fetching\n      try {\n        const response = await axios.get(`/posts/${postId}/likes/`);\n        const likes = response.data.usernames;\n        if (Array.isArray(likes)) {\n          setLikesCount(likes.length);\n          if (currentUser) {\n            setLiked(likes.includes(currentUser.username));\n          }\n        } else {\n          console.error(\"Expected an array of usernames.\");\n        }\n      } catch (error) {\n        console.error(error);\n        setErrorMessage('Failed to load likes');\n      } finally {\n        setLoading(false); // Reset loading state\n      }\n    };\n\n    fetchLikes();\n  }, [postId, currentUser]);\n  const toggleLike = async () => {\n    setLoading(true); // Set loading to true when toggling like\n    try {\n      if (!liked) {\n        await axios.post(`/posts/${postId}/like/`);\n        setLikesCount(prevCount => prevCount + 1);\n        setLiked(true);\n      } else {\n        await axios.delete(`/posts/${postId}/like/`);\n        setLikesCount(prevCount => prevCount - 1);\n        setLiked(false);\n      }\n      setErrorMessage('');\n    } catch (error) {\n      console.error(error);\n      setErrorMessage('Failed to update like status');\n    } finally {\n      setLoading(false); // Reset loading state\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: likeStyles.count,\n        children: [likesCount, \" \", likesCount === 1 ? 'like' : 'likes']\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 9\n      }, this), errorMessage && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: likeStyles.error,\n        children: errorMessage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 26\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }, this), currentUser ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Button, {\n        className: buttonStyles.like,\n        onClick: toggleLike,\n        disabled: loading || liked === null // Disable button while loading\n        ,\n        \"aria-pressed\": liked // Accessibility\n        ,\n        children: loading ? /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"Loading...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 15\n        }, this) // Loading feedback\n        : /*#__PURE__*/_jsxDEV(\"i\", {\n          className: `fa-regular ${liked ? 'fa-thumbs-down' : 'fa-thumbs-up'}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Link, {\n        className: likeStyles.link,\n        to: `/posts/${postId}/likes`,\n        children: \"View likes\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true) : /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Please log in to like this post.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 62,\n    columnNumber: 5\n  }, this);\n}\n_s(Likes, \"uXcQrDnC0x72i6PUIO7bSD0ySSY=\");\n_c = Likes;\nexport default Likes;\nvar _c;\n$RefreshReg$(_c, \"Likes\");","map":{"version":3,"names":["React","useState","useEffect","axios","Button","Link","likeStyles","buttonStyles","jsxDEV","_jsxDEV","Fragment","_Fragment","Likes","_ref","_s","postId","currentUser","liked","setLiked","likesCount","setLikesCount","errorMessage","setErrorMessage","loading","setLoading","fetchLikes","response","get","likes","data","usernames","Array","isArray","length","includes","username","console","error","toggleLike","post","prevCount","delete","children","className","count","fileName","_jsxFileName","lineNumber","columnNumber","like","onClick","disabled","link","to","_c","$RefreshReg$"],"sources":["/workspace/frontend-project5/src/components/interactions/Likes.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport Button from 'react-bootstrap/Button';\nimport { Link } from 'react-router-dom';\nimport likeStyles from '../../styles/likes/Likes.module.css';\nimport buttonStyles from '../../styles/Buttons.module.css';\n\nfunction Likes({ postId, currentUser }) {\n  const [liked, setLiked] = useState(null);\n  const [likesCount, setLikesCount] = useState(0);\n  const [errorMessage, setErrorMessage] = useState('');\n  const [loading, setLoading] = useState(false); // Loading state\n\n  useEffect(() => {\n    const fetchLikes = async () => {\n      setLoading(true); // Set loading to true when fetching\n      try {\n        const response = await axios.get(`/posts/${postId}/likes/`);\n        const likes = response.data.usernames;\n\n        if (Array.isArray(likes)) {\n          setLikesCount(likes.length);\n          if (currentUser) {\n            setLiked(likes.includes(currentUser.username));\n          }\n        } else {\n          console.error(\"Expected an array of usernames.\");\n        }\n      } catch (error) {\n        console.error(error);\n        setErrorMessage('Failed to load likes');\n      } finally {\n        setLoading(false); // Reset loading state\n      }\n    };\n\n    fetchLikes();\n  }, [postId, currentUser]);\n\n  const toggleLike = async () => {\n    setLoading(true); // Set loading to true when toggling like\n    try {\n      if (!liked) {\n        await axios.post(`/posts/${postId}/like/`);\n        setLikesCount((prevCount) => prevCount + 1);\n        setLiked(true);\n      } else {\n        await axios.delete(`/posts/${postId}/like/`);\n        setLikesCount((prevCount) => prevCount - 1);\n        setLiked(false);\n      }\n      setErrorMessage('');\n    } catch (error) {\n      console.error(error);\n      setErrorMessage('Failed to update like status');\n    } finally {\n      setLoading(false); // Reset loading state\n    }\n  };\n\n  return (\n    <div>\n      <div>\n        <span className={likeStyles.count}>\n          {likesCount} {likesCount === 1 ? 'like' : 'likes'}\n        </span>\n        {errorMessage && <p className={likeStyles.error}>{errorMessage}</p>}\n      </div>\n      {currentUser ? (\n        <>\n          <Button\n            className={buttonStyles.like}\n            onClick={toggleLike}\n            disabled={loading || liked === null} // Disable button while loading\n            aria-pressed={liked} // Accessibility\n          >\n            {loading ? (\n              <span>Loading...</span> // Loading feedback\n            ) : (\n              <i className={`fa-regular ${liked ? 'fa-thumbs-down' : 'fa-thumbs-up'}`}></i>\n            )}\n          </Button>\n          <Link className={likeStyles.link} to={`/posts/${postId}/likes`}>\n            View likes\n          </Link>\n        </>\n      ) : (\n        <p>Please log in to like this post.</p>\n      )}\n    </div>\n  );\n}\n\nexport default Likes;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAOC,MAAM,MAAM,wBAAwB;AAC3C,SAASC,IAAI,QAAQ,kBAAkB;AACvC,OAAOC,UAAU,MAAM,qCAAqC;AAC5D,OAAOC,YAAY,MAAM,iCAAiC;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAAA,SAAAC,QAAA,IAAAC,SAAA;AAE3D,SAASC,KAAKA,CAAAC,IAAA,EAA0B;EAAAC,EAAA;EAAA,IAAzB;IAAEC,MAAM;IAAEC;EAAY,CAAC,GAAAH,IAAA;EACpC,MAAM,CAACI,KAAK,EAAEC,QAAQ,CAAC,GAAGjB,QAAQ,CAAC,IAAI,CAAC;EACxC,MAAM,CAACkB,UAAU,EAAEC,aAAa,CAAC,GAAGnB,QAAQ,CAAC,CAAC,CAAC;EAC/C,MAAM,CAACoB,YAAY,EAAEC,eAAe,CAAC,GAAGrB,QAAQ,CAAC,EAAE,CAAC;EACpD,MAAM,CAACsB,OAAO,EAAEC,UAAU,CAAC,GAAGvB,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC;;EAE/CC,SAAS,CAAC,MAAM;IACd,MAAMuB,UAAU,GAAG,MAAAA,CAAA,KAAY;MAC7BD,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC;MAClB,IAAI;QACF,MAAME,QAAQ,GAAG,MAAMvB,KAAK,CAACwB,GAAG,CAAE,UAASZ,MAAO,SAAQ,CAAC;QAC3D,MAAMa,KAAK,GAAGF,QAAQ,CAACG,IAAI,CAACC,SAAS;QAErC,IAAIC,KAAK,CAACC,OAAO,CAACJ,KAAK,CAAC,EAAE;UACxBR,aAAa,CAACQ,KAAK,CAACK,MAAM,CAAC;UAC3B,IAAIjB,WAAW,EAAE;YACfE,QAAQ,CAACU,KAAK,CAACM,QAAQ,CAAClB,WAAW,CAACmB,QAAQ,CAAC,CAAC;UAChD;QACF,CAAC,MAAM;UACLC,OAAO,CAACC,KAAK,CAAC,iCAAiC,CAAC;QAClD;MACF,CAAC,CAAC,OAAOA,KAAK,EAAE;QACdD,OAAO,CAACC,KAAK,CAACA,KAAK,CAAC;QACpBf,eAAe,CAAC,sBAAsB,CAAC;MACzC,CAAC,SAAS;QACRE,UAAU,CAAC,KAAK,CAAC,CAAC,CAAC;MACrB;IACF,CAAC;;IAEDC,UAAU,EAAE;EACd,CAAC,EAAE,CAACV,MAAM,EAAEC,WAAW,CAAC,CAAC;EAEzB,MAAMsB,UAAU,GAAG,MAAAA,CAAA,KAAY;IAC7Bd,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC;IAClB,IAAI;MACF,IAAI,CAACP,KAAK,EAAE;QACV,MAAMd,KAAK,CAACoC,IAAI,CAAE,UAASxB,MAAO,QAAO,CAAC;QAC1CK,aAAa,CAAEoB,SAAS,IAAKA,SAAS,GAAG,CAAC,CAAC;QAC3CtB,QAAQ,CAAC,IAAI,CAAC;MAChB,CAAC,MAAM;QACL,MAAMf,KAAK,CAACsC,MAAM,CAAE,UAAS1B,MAAO,QAAO,CAAC;QAC5CK,aAAa,CAAEoB,SAAS,IAAKA,SAAS,GAAG,CAAC,CAAC;QAC3CtB,QAAQ,CAAC,KAAK,CAAC;MACjB;MACAI,eAAe,CAAC,EAAE,CAAC;IACrB,CAAC,CAAC,OAAOe,KAAK,EAAE;MACdD,OAAO,CAACC,KAAK,CAACA,KAAK,CAAC;MACpBf,eAAe,CAAC,8BAA8B,CAAC;IACjD,CAAC,SAAS;MACRE,UAAU,CAAC,KAAK,CAAC,CAAC,CAAC;IACrB;EACF,CAAC;;EAED,oBACEf,OAAA;IAAAiC,QAAA,gBACEjC,OAAA;MAAAiC,QAAA,gBACEjC,OAAA;QAAMkC,SAAS,EAAErC,UAAU,CAACsC,KAAM;QAAAF,QAAA,GAC/BvB,UAAU,EAAC,GAAC,EAACA,UAAU,KAAK,CAAC,GAAG,MAAM,GAAG,OAAO;MAAA;QAAA0B,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,QAC5C,EACN3B,YAAY,iBAAIZ,OAAA;QAAGkC,SAAS,EAAErC,UAAU,CAAC+B,KAAM;QAAAK,QAAA,EAAErB;MAAY;QAAAwB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,QAAK;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,QAC/D,EACLhC,WAAW,gBACVP,OAAA,CAAAE,SAAA;MAAA+B,QAAA,gBACEjC,OAAA,CAACL,MAAM;QACLuC,SAAS,EAAEpC,YAAY,CAAC0C,IAAK;QAC7BC,OAAO,EAAEZ,UAAW;QACpBa,QAAQ,EAAE5B,OAAO,IAAIN,KAAK,KAAK,IAAK,CAAC;QAAA;QACrC,gBAAcA,KAAM,CAAC;QAAA;QAAAyB,QAAA,EAEpBnB,OAAO,gBACNd,OAAA;UAAAiC,QAAA,EAAM;QAAU;UAAAG,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,QAAO,CAAC;QAAA,eAExBvC,OAAA;UAAGkC,SAAS,EAAG,cAAa1B,KAAK,GAAG,gBAAgB,GAAG,cAAe;QAAE;UAAA4B,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MACzE;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,QACM,eACTvC,OAAA,CAACJ,IAAI;QAACsC,SAAS,EAAErC,UAAU,CAAC8C,IAAK;QAACC,EAAE,EAAG,UAAStC,MAAO,QAAQ;QAAA2B,QAAA,EAAC;MAEhE;QAAAG,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,QAAO;IAAA,gBACN,gBAEHvC,OAAA;MAAAiC,QAAA,EAAG;IAAgC;MAAAG,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,QACpC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,QACG;AAEV;AAAClC,EAAA,CApFQF,KAAK;AAAA0C,EAAA,GAAL1C,KAAK;AAsFd,eAAeA,KAAK;AAAC,IAAA0C,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}